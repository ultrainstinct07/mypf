---
title: "Phishing Detection System"
description: "Python-based multi-factor phishing classifier using domain reputation, SSL checks, content heuristics, and Vulners CVE lookups."
tags: ["Security", "Detection", "Python"]
image: "/images/projects/phishing-detector.svg"
repoUrl: "https://github.com/kshitiz/phishing-detector"
techStack: ["Python", "Vulners API", "scikit-learn", "BeautifulSoup", "DNS Python"]
featured: true
---

## Overview

A comprehensive phishing detection system that analyzes URLs through multiple security lenses to identify malicious websites. The system combines traditional heuristics with threat intelligence APIs to provide accurate, real-time phishing detection.

## Detection Methodology

### Multi-Factor Analysis

The system employs a layered approach to phishing detection:

#### 1. Domain Analysis
- **WHOIS Lookup**: Check domain age, registrar, and registration patterns
- **DNS Records**: Analyze MX, TXT, and nameserver configurations
- **Subdomain Depth**: Flag suspicious subdomain structures
- **URL Entropy**: Detect obfuscated or randomly generated URLs

#### 2. SSL/TLS Inspection
- Certificate validation and issuer verification
- Check for self-signed certificates
- Verify certificate expiration dates
- Analyze cipher suite security
- Detect certificate transparency violations

#### 3. Content Analysis
- HTML structure analysis for login forms
- Keyword detection (password, login, verify, urgent)
- Brand impersonation detection via logo/favicon matching
- External resource analysis (scripts, iframes)
- Meta tag inspection for cloaking attempts

#### 4. Threat Intelligence
- **Vulners API**: CVE and vulnerability lookups
- **URLhaus**: Known malicious URL database
- **PhishTank**: Community-driven phishing database
- **VirusTotal**: Multi-engine URL scanning

## Technical Architecture

### Core Components

```
URL Input
    ↓
Feature Extraction
    ├── Domain Features
    ├── SSL Features
    ├── Content Features
    └── Threat Intel Features
    ↓
ML Classifier
    ├── Random Forest
    ├── XGBoost
    └── Neural Network (ensemble)
    ↓
Risk Score (0-100)
```

### Machine Learning Pipeline

#### Feature Engineering
- Extracted 47 distinct features across 4 categories
- Feature normalization and scaling
- Dimensionality reduction using PCA
- Feature importance analysis for model interpretability

#### Model Training
- Dataset: 50,000+ labeled URLs (phishing + legitimate)
- Train/validation/test split: 70/15/15
- Cross-validation with 5 folds
- Hyperparameter tuning using Optuna

#### Model Performance
- **Accuracy**: 96.3%
- **Precision**: 94.7%
- **Recall**: 97.2%
- **F1-Score**: 95.9%
- **False Positive Rate**: 3.1%

## Key Features

### Real-Time Scanning
- Average scan time: 2-3 seconds
- Parallel processing for batch scans
- Asynchronous API calls for external services
- Caching for repeated URL checks

### API Integration
```python
# Vulners CVE Lookup
def check_vulnerabilities(domain):
    vulners = VulnersAPI(api_key=API_KEY)
    results = vulners.domain_search(domain)
    return parse_vulnerabilities(results)
```

### Browser Extension
- Chrome/Firefox extension for real-time protection
- Visual warning indicators
- Click-through warnings for suspicious links
- Whitelist management

## Security Considerations

### Input Validation
- URL sanitization to prevent SSRF attacks
- Rate limiting to prevent abuse
- Sandboxed content rendering
- DNS rebinding protection

### Privacy Protection
- No URL logging by default (privacy mode)
- Anonymized telemetry
- Local-first processing option
- GDPR-compliant data handling

## Deployment Options

### Cloud API
- RESTful API on AWS Lambda
- DynamoDB for result caching
- CloudWatch for monitoring
- API Gateway for rate limiting

### Self-Hosted
- Docker container for easy deployment
- Lightweight (< 500MB image)
- Configurable threat intelligence sources
- Local model inference

### Command-Line Tool
```bash
$ phish-detect https://suspicious-site.com
[WARNING] High risk score: 87/100

Risk factors:
- Domain registered 2 days ago
- Self-signed SSL certificate
- Contains login form mimicking PayPal
- Found in PhishTank database
```

## Real-World Impact

### Statistics
- Scanned 1M+ URLs since deployment
- Detected 47,000+ phishing attempts
- Average detection time: 2.3 seconds
- False positive rate: 3.1%

### Use Cases
- Corporate email filtering
- SOC automation workflows
- Security awareness training
- Threat intelligence enrichment

## Lessons Learned

### Challenge: False Positives
**Solution**: Implemented confidence scoring and manual review queue for borderline cases

### Challenge: Evasion Techniques
**Solution**: Continuous model retraining with adversarial examples

### Challenge: API Rate Limits
**Solution**: Intelligent caching and fallback to local heuristics

## Future Enhancements

- Deep learning for screenshot analysis
- Integration with SIEM platforms
- Browser behavior analysis
- Honeypot integration for zero-day phishing detection
- Mobile app for on-the-go scanning

## Contributing

This project is open source and welcomes contributions. Areas of interest:
- Additional threat intelligence sources
- Performance optimization
- New ML models and architectures
- Documentation and tutorials
